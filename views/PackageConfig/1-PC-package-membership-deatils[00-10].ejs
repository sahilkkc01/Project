<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>LifeLinker</title>

  <!-- Template CSS -->
  <%- include('../header'); -%>

    <!-- main content start -->
    <div class="main-content">

      <div class="row content-top-gap2">
        <div class="col-lg-12">
          <nav class="navbar navbar-expand-lg navbar-light bg-white">
            <a class="navbar-brand text-center mr-5" href="#">
              <span class="dash-icon"><i class="fas fa-tachometer-alt"></i></span>
              Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
              aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item active text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="far fa-user"></i></span>
                    Master
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-exchange-alt"></i></span>
                    Transaction
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-hand-holding-medical"></i></span>
                    Patient 360
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-receipt"></i></span>
                    Outside Reciept
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-file-invoice"></i></span>
                    Outpatient Department
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-chart-line"></i></span>
                    Analytics
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="far fa-clock"></i></span>
                    Waiting List
                  </a>
                </li>
                <li class="nav-item text-center mr-5">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-wrench"></i></span>
                    Adminstration
                  </a>
                </li>
                <li class="nav-item text-center">
                  <a class="nav-link" href="#">
                    <span class="dash-icon"><i class="fas fa-spinner"></i></span>
                    Additional
                  </a>
                </li>

              </ul>
            </div>
          </nav>
        </div>
      </div>
      <!-- content -->
      <div class="container-fluid">

        <div class="chart">
          <div class="row">

            <div class="col-lg-12 pl-lg-0 mt-2 ml-2">
              <h4 class="primary">Package Membership Details</h4>
            </div>
            <div class="col-lg-12 pl-lg-2 chart-grid">
              <div class="card card_border">


                <div class="">
                  <!--Past your code here starts-->

                  <form id="">

                    <div class="card">
                      <div class="col-xl-12 p-heading">
                        <h6 class="p-text">List of Packages</h6>
                      </div>
                      <div class="card-body">
                        <!-- <div class="pl-xl-0 mb-2">
                                                    <h6 class="primary">List of Packages</h6>
                                                </div> -->
                        <div class="form-row">
                          <div class="col-6 mb-3">
                            <div class="form-group"><label class="input__label">Package
                                Name</label><input name="package_name" type="text" class="form-control input-style"
                                placeholder="">
                            </div>
                          </div>

                          <div class="col-5">
                            <div class="form-group">
                              <label class="input__label pl-2">Specialization</label><select name="specialization"
                                class="form-control input-style ml-2">
                                <option></option>
                              </select>
                            </div>
                          </div>

                          <div class="col-1">
                            <div class="form-group text-right">
                              <button type="button" class="btn-primary btn-style btn mt-4 btn-change text-right"
                                id="searchBox"><strong><i class="fa-solid fa-magnifying-glass"></i>
                                  Search</strong></button>
                            </div>
                          </div>
                        </div>

                        <div class="form-row">
                          <div class="col-12 mb-0">
                            <div class="form-group">
                              <div class="col col-12 pr-xl-0 pl-xl-0">
                                <div class="slidx">

                                  <table class="table2" id="data-table">
                                    <thead>
                                      <tr>
                                        <th contenteditable="true">Code </th>
                                        <th contenteditable="true">Package Name</th>
                                        <th contenteditable="true">Short Description
                                        </th>
                                        <th contenteditable="true">Long Description
                                        </th>
                                        <th contenteditable="true">Specialization
                                        </th>
                                        <th contenteditable="true">Sub
                                          Specialization</th>
                                        <th contenteditable="true">Rate</th>
                                        <th contenteditable="true">Status</th>
                                        <th contenteditable="true">Package Freezed
                                        </th>
                                        <th contenteditable="true">Package Approved
                                        </th>
                                      </tr>
                                    </thead>
                                    <tbody id="categtable">
                                      <tr>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"><input class="form-check-input mt-1 " type="checkbox"
                                            id="gridCheck1"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                      </tr>
                                      <tr>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"><input class="form-check-input mt-1" type="checkbox"
                                            id="gridCheck1"></td>
                                        <td contenteditable="true"></td>
                                        <td contenteditable="true"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                  <div class="paginationControls"></div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!--Past your code here ends-->
                </div>
              </div>
              <div class="form-group mt-1 mb-3 text-right">

                <!-- <button id="myButton1" data-bs-toggle="modal" data-bs-target="#myModal1" type="button"
                  class="btn-secondary btn-style btn mt-3 mr-2" disabled><strong> Assign Consent</strong></button>
                <button id="myButton2" type="button" class="btn-secondary btn-style btn mt-3 mr-2"
                  data-bs-toggle="modal" data-bs-target="#myModal2" disabled onclick="fetchAllTariff()"><strong>Assign
                    Tariff</strong></button> -->
                <button id="myButton3" type="button" class="btn-primary btn-style btn mt-3 mr-2" data-bs-toggle="modal"
                  data-bs-target="#myModal3" disabled onclick="fetchServicesData()"><strong>
                    Package Defination</strong></button>
                <!-- <button type="button" class="btn-success btn-style btn mt-3 mr-2" disabled><strong><i
                      class="fa-regular fa-pen-to-square"></i> Modify</strong></button> -->
                <a href="/package/2"><button type="button" class="btn-secondary btn-style btn mt-3 mr-2"><strong><i
                        class="fa-solid fa-plus"></i> New</strong></button></a>
                <!-- <button type="button" class="btn-danger btn-style btn mt-3 mr-2" disabled><strong><i
                      class="fas fa-times"></i> Cancel</strong></button>
                <button type="button" class="btn-primary btn-style btn mt-3" disabled><strong><i
                      class="far fa-save"></i>
                    Save</strong></button> -->
              </div>
              </form>
            </div>

            <!-- The Modal -->
            <!-- Assign Consent -->
            <div class="modal" id="myModal1" tabindex="-1">
              <div class="modal-dialog modal-xl">
                <div class="modal-content">

                  <!-- Modal Header -->
                  <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <i class="fa-solid fa-circle-xmark"></i>
                    </button>
                  </div>

                  <!-- Modal Body -->
                  <div class="modal-body">
                    <div class="row">
                      <div class="col-lg-12 pl-lg-2 chart-grid">
                        <div id="errordiv1"></div>
                        <form id="concent_form">
                          <input type="text" name="package_code" id="package_code">
                          <div class="card card_border">
                            <div class="card">
                              <div class="col-xl-12 p-heading">
                                <h6 class="p-text">SEARCH CONSENT</h6>
                              </div>

                              <div class="card-body pb-3 pt-2">
                                <div class="row">
                                  <div class="col-lg-6 col-md-5 col-sm-12 mb-2">
                                    <div class="form-group">
                                      <label class="input__label">Department</label>
                                      <select name="report_generated_by" class="form-control input-style">
                                        <option>Select</option>
                                      </select>
                                    </div>
                                  </div>

                                  <div class="col-lg-5 col-md-5 col-sm-12 mb-2">
                                    <div class="form-group">
                                      <label class="input__label">Template Name</label>
                                      <select name="report_generated_by" class="form-control input-style">
                                        <option>Select</option>
                                      </select>
                                    </div>
                                  </div>

                                  <div class="col-lg-1 col-md-2 col-sm-12 text-end">
                                    <div class="form-group">
                                      <button type="button" class="btn btn-style mt-4 btn-primary btn-change">
                                        <strong><i class="fas fa-search"></i> Search</strong>
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-12">
                                    <div class="form-group">
                                      <div class="col col-12 pr-xl-0 pl-xl-0">
                                        <div class="slidx">
                                          <table class="table2">
                                            <thead>
                                              <tr>
                                                <th contenteditable="true" width="15%"></th>
                                                <th contenteditable="true">Consent</th>
                                              </tr>
                                            </thead>
                                            <tbody id="concentBody">
                                             
                                            </tbody>
                                          </table>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!-- Buttons -->
                            <div class="form-group mt-1 mb-3 text-end">
                              <button type="button" class="btn btn-danger btn-style mt-3 me-2">
                                <strong><i class="fas fa-times"></i> Cancel</strong>
                              </button>
                              <button type="submit" class="btn btn-primary btn-style mt-3">
                                <strong><i class="far fa-save"></i> Save</strong>
                              </button>
                            </div>

                          </div>
                        </form>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- Assign Tariff Model -->
            <div class="modal" id="myModal2" tabindex="-1">
              <div class="modal-dialog modal-xl">
                <div class="modal-content">

                  <!-- Modal Header -->
                  <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <i class="fa-solid fa-circle-xmark"></i>
                    </button>
                  </div>

                  <!-- Modal Body -->
                  <div class="modal-body">
                    <div class="chart">
                      <div class="row">
                        <div class="col-lg-12 pl-lg-2 chart-grid">
                          <form>
                            <div class="card card_border mt-3">
                              <div>
                                <div class="card">
                                  <div>
                                    <div class="form-group">
                                      <div class="col-xl-12 p-heading">
                                        <h6 class="p-text">SERVICE NAME : Additional Medicine Package 1</h6>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="card-body pt-2">
                                    <h6 class="primary">SELECT THE OPERATION YOU WANT</h6>
                                    <div class="form-row">
                                      <div class="col-lg-12 col-md-12 col-sm-12">
                                        <div class="form-check">
                                          <input class="form-check-input" type="radio" name="operation"
                                            id="linkWithTariff" value="link">
                                          <label class="form-check-label" for="linkWithTariff">Link With Tariff /
                                            Package</label>
                                        </div>
                                      </div>
                                      <div class="col-lg-12 col-md-12 col-sm-12 mt-2">
                                        <div class="form-check">
                                          <input class="form-check-input" type="radio" name="operation" id="changeRate"
                                            value="change" onclick="fetchAllTariff()">
                                          <label class="form-check-label" for="changeRate">Change Rate Of Existing
                                            Tariff / Package</label>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                        </div>
                        <div class="form-group mt-1 mb-3 text-right">
                          <button type="button" class="btn-danger btn-style btn mr-2"><strong><i
                                class="fas fa-times"></i> Cancel</strong></button>
                          <button type="button" id="okButton" class="btn-primary btn-style btn"><strong><i
                                class="fas fa-check"></i> OK</strong></button>
                        </div>
                        </form>
                      </div>

                      <!-- Modals -->
                      <div class="modal fade" id="linkModal" data-tabindex="-1" aria-labelledby="linkModalLabel"
                        aria-hidden="true" style="background:#66666694">
                        <div class="modal-dialog modal-lg">
                          <div class="modal-content">
                            <div class="modal-header">
                              <a href="#" class="btn-close" data-bs-dismiss="modal"><i
                                  class="fa-solid fa-circle-xmark"></i></a>
                            </div>
                            <div class="modal-body">
                              <div class="chart">
                                <div class="row">
                                  <div class="col-lg-12 pl-lg-2 chart-grid">
                                    <form>
                                      <div class="card card_border mt-3">
                                        <div>
                                          <div class="card">
                                            <div>
                                              <div class="form-group">
                                                <div class="col-xl-12 p-heading">
                                                  <h6 class="p-text">SERVICE NAME : Additional Medicine Package 1</h6>
                                                </div>
                                              </div>
                                            </div>
                                            <div class="card-body pt-2 pb-0">
                                              <h6 class="primary">FILTER BY</h6>
                                            </div>
                                            <div class="form-row card-body pt-lg-0 pb-3">
                                              <div class="col-lg-1 col-md-6 col-sm-12">
                                                <div class="form-check-label">
                                                  <div class="radio mt-2">
                                                    <label class="form-check-label pt-1"><input
                                                        class="form-check-input mt-1" type="radio" checked>
                                                      Teriff</label>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="col-lg-6 col-md-6 col-sm-12">
                                                <div class="form-check-label">
                                                  <div class="radio mt-2">
                                                    <label class="form-check-label pt-1 pr-4"><input
                                                        onclick="loadTariff()" data-bs-toggle="modal"
                                                        data-bs-target="#myModal21a" data-bs-target="#myModal"
                                                        class="form-check-input mt-1" type="checkbox"
                                                        id="applyRateToAllCheckbox">
                                                      Apply Rate To All</label>
                                                    <label class="form-check-label pt-1 pl-4"><input
                                                        class="form-check-input mt-1" id="searchTariffCheckbox"
                                                        type="checkbox">
                                                      Search Tariff</label>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                            <div class="form-row card-body pt-lg-0 pb-3" id="searchFieldContainer">
                                              <!-- Search field will be inserted here -->
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                  </div>
                                  <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                                    <div class="card card_border">
                                      <div class="mb-3">
                                        <div class="form-group">
                                          <div class="col-xl-12 p-heading">
                                            <h6 class="p-text">ASSIGN RATE</h6>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="form-row card-body pt-0 pb-3">
                                        <div class="col-12 mb-0">
                                          <div class="form-group">
                                            <div class="col col-12 pr-xl-0 pl-xl-0">
                                              <div class="slidx">
                                                <table class="table2" id="tariffTable">
                                                  <thead>
                                                    <tr>
                                                      <th contenteditable="true">Select</th>
                                                      <th contenteditable="true">Class Name</th>
                                                      <th contenteditable="true">Rate</th>
                                                    </tr>
                                                  </thead>
                                                  <tbody id="tariffBody">
                                                    <!-- <tr>
                                                      <td contenteditable="true" colspan="3" class="text-left pl-4">
                                                        <i class="fa-solid fa-caret-down pr-2"
                                                          style="color: #11CDF0;"></i> Tariff Name: F9F (1 item)
                                                      </td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">IPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">OPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" colspan="3" class="text-left pl-4">
                                                        <i class="fa-solid fa-caret-down pr-2"
                                                          style="color: #11CDF0;"></i> Tariff Name: Karimnagar (1 item)
                                                      </td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">IPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">OPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" colspan="3" class="text-left pl-4">
                                                        <i class="fa-solid fa-caret-down pr-2"
                                                          style="color: #11CDF0;"></i> Tariff Name: Vijyawada (2 item)
                                                      </td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">OPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" colspan="3" class="text-left pl-4">
                                                        <i class="fa-solid fa-caret-down pr-2"
                                                          style="color: #11CDF0;"></i> Tariff Name: F8j (2 item)
                                                      </td>
                                                    </tr>
                                                    <tr>
                                                      <td contenteditable="true" width="10%"><input
                                                          class="form-check-input mt-1" type="checkbox" id="gridCheck1">
                                                      </td>
                                                      <td contenteditable="true">OPD</td>
                                                      <td contenteditable="true" width="15%">1600.00</td>
                                                    </tr> -->
                                                  </tbody>
                                                </table>
                                              </div>
                                              <div id="paginationControls"></div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group mt-1 mb-3 text-right">
                                  <button type="button" class="btn-danger btn-style btn mr-2"
                                    data-bs-dismiss="modal"><strong><i class="fas fa-times"></i> Close</strong></button>
                                  <button type="button" id="okButton" class="btn-primary btn-style btn"><strong><i
                                        class="fas fa-check"></i> Save</strong></button>
                                </div>
                                </form>
                              </div>

                              <!-- Pop Up inside Model -->
                              <div class="modal mt-5" id="myModal21a" tabindex="-1" aria-labelledby="exampleModalLabel"
                                aria-hidden="true" style="background:#66666694">
                                <div class="modal-dialog">
                                  <div class="modal-content">
                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                      <a href="#" class="btn-close" data-bs-dismiss="modal"><i
                                          class="fa-solid fa-circle-xmark"></i></a>
                                    </div>
                                    <!-- Modal body -->
                                    <div class="modal-body">
                                      <div class="primary mb-2">
                                        Apply Class Rate To All Tariff
                                      </div>
                                      <div>
                                        <input type="checkbox" id="applyBaseRateCheckbox" onclick="getNewModule()">
                                        <label for="applyBaseRateCheckbox">Apply Base Rate</label>
                                      </div>
                                      <table class="table2" id="selectedServicesTable">
                                        <thead>
                                          <tr>
                                            <th>Select</th>
                                            <th>Class Name</th>
                                            <th>Rate</th>
                                          </tr>
                                        </thead>
                                        <tbody id="selectedServicesBody">
                                        </tbody>
                                      </table>
                                      <div id="paginationControlsSer"></div>
                                      <div class="form-group mt-1 mb-3 text-right">
                                        <button type="button" class="btn-danger btn-style btn btn-close mr-2"
                                          id="modalCancelButton" data-bs-dismiss="modal"><strong><i
                                              class="fas fa-times"></i>
                                            Cancel</strong></button>
                                        <button type="button" id="okButton" class="btn-primary btn-style btn"
                                          data-bs-toggle="modal" data-bs-target="#myModal"><strong><i
                                              class="fas fa-check"></i> OK</strong></button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="modal fade" id="changeModal" tabindex="-1" aria-labelledby="changeModalLabel"
                        aria-hidden="true" style="background:#66666694">
                        <div class="modal-dialog modal-lg">
                          <div class="modal-content">
                            <div class="modal-header">
                              <a href="#" class="btn-close" data-bs-dismiss="modal"><i
                                  class="fa-solid fa-circle-xmark"></i></a>
                            </div>
                            <div class="modal-body">
                              <div class="chart">
                                <div class="row">
                                  <div class="col-lg-12 pl-lg-2 chart-grid">
                                    <form>
                                      <div class="card card_border mt-3">
                                        <div>
                                          <div class="card">
                                            <div>
                                              <div class="form-group">
                                                <div class="col-xl-12 p-heading">
                                                  <h6 class="p-text">SERVICE NAME : Additional Medicine Package 1</h6>
                                                </div>
                                              </div>
                                            </div>
                                            <div class="card-body pt-2 pb-0">
                                              <h6 class="primary">FILTER BY</h6>
                                            </div>
                                            <div class="form-row card-body pt-lg-0 pb-3">
                                              <div class="col-lg-1 col-md-6 col-sm-12">
                                                <div class="form-check-label">
                                                  <div class="radio mt-2">
                                                    <label class="form-check-label pt-1"><input
                                                        class="form-check-input mt-1" type="radio" checked>
                                                      Teriff</label>
                                                  </div>
                                                </div>
                                              </div>
                                              <div class="col-lg-6 col-md-6 col-sm-12">
                                                <div class="form-check-label">
                                                  <div class="radio mt-2">
                                                    <label class="form-check-label pt-1 pr-4"><input
                                                        data-bs-toggle="modal" data-bs-target="#myModal22a"
                                                        class="form-check-input mt-1" type="checkbox"
                                                        id="applyRateToAllCheckbox">
                                                      Apply Rate To All</label>
                                                    <label class="form-check-label pt-1 pl-4"><input
                                                        class="form-check-input mt-1" id="searchTariffCheckbox2"
                                                        type="checkbox">
                                                      Search Tariff</label>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                            <div class="form-row card-body pt-lg-0 pb-3" id="searchFieldContainer2">
                                              <!-- Search field will be inserted here -->
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                  </div>
                                  <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                                    <div class="card card_border">
                                      <div class="mb-3">
                                        <div class="form-group">
                                          <div class="col-xl-12 p-heading">
                                            <h6 class="p-text">ASSIGN RATE</h6>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="form-row card-body pt-0 pb-3">
                                        <div class="col-12 mb-0">
                                          <div class="form-group">
                                            <div class="col col-12 pr-xl-0 pl-xl-0">
                                              <div class="slidx">
                                                <table class="table2" id="serviceTable1">
                                                  <thead>
                                                    <tr>
                                                      <th contenteditable="true">Select</th>
                                                      <th contenteditable="true">Class Name</th>
                                                      <th contenteditable="true">Rate</th>
                                                    </tr>
                                                  </thead>
                                                  <tbody id="serviceBody1">

                                                  </tbody>
                                                </table>
                                              </div>
                                              <div id="paginationControls"></div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="form-group mt-1 mb-3 text-right">
                                  <button type="button" class="btn-danger btn-style btn mr-2"><strong><i
                                        class="fas fa-times"></i> Close</strong></button>
                                  <button type="button" id="okButton" class="btn-primary btn-style btn"><strong><i
                                        class="fas fa-check"></i> Save</strong></button>
                                </div>
                                </form>
                              </div>

                              <!-- Pop Up inside Model -->

                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Package Defination -->
            <div class="modal" id="myModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <!-- Modal Header -->
                  <div class="modal-header">
                    <a href="#" class="btn-close" data-bs-dismiss="modal"><i class="fa-solid fa-circle-xmark"></i></a>
                  </div>
                  <!-- Modal body -->
                  <div class="modal-body">
                    <div class="row">
                      <div class="chart">
                        <div class="row">
                          <!-- <div class="col-lg-12 pl-lg-0 mt-2 ml-2">
                            <h4 class="primary">Company</h4>
                        </div> -->
                          <div class="col-lg-12 pl-lg-2 chart-grid">
                            <form>
                              <div class="card card_border mt-3">
                                <div>
                                  <!--Past your code here starts-->
                                  <div class="container mt-5">
                                    <div class="card">
                                      <div class="form-row card-body pb-2 pt-2">
                                        <div class="col-3">
                                          <div class="form-group">
                                            <label class="input__label">Package Name</label>
                                            <input disabled id="packageName" name="packageName" type="text"
                                              class="form-control input-style" placeholder="">
                                          </div>
                                        </div>

                                        <div class="col-3">
                                          <div class="form-group">
                                            <label class="input__label">Package Amount</label>
                                            <input id="packageAmount" name="packageAmount" type="number"
                                              class="form-control input-style" placeholder="" disabled>
                                          </div>
                                        </div>

                                        <div class="col-3">
                                          <div class="form-group">
                                            <label class="input__label">Package Duration</label>
                                            <div class="d-flex">
                                              <input id="packageDuration" name="packageDuration" type="text"
                                                class="form-control input-style me-2" style="width: 50%;"
                                                placeholder="">
                                              <select name="report_generated_by" class="form-control input-style">
                                                <option>Days</option>
                                                <option>Months</option>
                                              </select>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="card-body pt-2 pb-2">
                                        <h6 class="primary">DISTRIBUTION DETAILS</h6>
                                      </div>
                                      <div class="form-row card-body pt-lg-0 pb-0">
                                        <div class="col-lg-3 col-md-6 col-sm-12">
                                          <div class="form-group">
                                            <label class="input__label">Service Component</label>
                                            <input id="serviceComponent" name="count" type="number"
                                              class="form-control input-style" placeholder="0">
                                          </div>
                                        </div>
                                        <div class="col-lg-3 col-md-6 col-sm-12">
                                          <div class="form-group">
                                            <label class="input__label">Pharmacy Component</label>
                                            <input id="pharmacyComponent" name="count" type="number"
                                              class="form-control input-style" placeholder="0">
                                          </div>
                                        </div>
                                        <div class="col-lg-3 col-md-6 col-sm-12">
                                          <div class="form-check-label">
                                            <div class="radio my-4" id="my-radio-button">
                                              <label class="form-check-label pt-1"><input name="checkAmountType" id="fixed" class="form-check-input mt-1"
                                                  type="radio"> Fixed</label>
                                              <label class="form-check-label pl-4 pt-1"><input
                                                  class="form-check-input mt-1" id="percentage" name="checkAmountType" type="radio"> Percentage</label>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="col-lg-3 col-md-6 col-sm-12">
                                          <div class="form-check-label">
                                            <div class="radio my-4">
                                              <label class="form-check-label pt-1"><input class="form-check-input mt-1"
                                                  type="checkbox"> Freeze Package</label>
                                            </div>
                                          </div>
                                        </div>
                            </form>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
                <!--section2-->
                <nav>
                  <div class="nav nav-tabs" id="nav-tab" role="tablist">

                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#nav-appointment" type="button"
                      role="tab" aria-controls="nav-appointment" aria-selected="false"><i
                        class="fas fa-calendar-alt"></i> Services </button>

                    <button class="nav-link " id="nav-followup-tab" data-bs-toggle="tab" data-bs-target="#nav-followup"
                      type="button" role="tab" aria-controls="nav-followup" aria-selected="true"><i
                        class="fas fa-exchange-alt"></i> Pharmacy Items</button>

                  </div>
                </nav>
                <div class="col-md-12 tab-content" id="nav-tabContent">

                  <!--Div pharmacy starts-->
                  <div class="tab-pane fade show " id="nav-followup" role="tabpanel" aria-labelledby="nav-followup-tab">
                    <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                      <div class="card card_border">
                        <div class="mb-3">
                          <div class="form-group">
                            <div class="col-xl-12 p-heading">
                              <!-- Nav Tabs are here once have a look--->
                              <h6 class="p-text">PHARMACY ITEMS</h6>
                            </div>
                          </div>
                        </div>
                        <div class="card-body pt-0">
                          <h6 class="primary">LIST OF ITEMSS</h6>
                        </div>
                        <form id="saveItem">
                          <div class="form-row card-body pt-1">
                            <div class="col-12">
                              <div class="form-group">
                                <div class="col col-12 pr-xl-0 pl-xl-0">
                                  <div class="slidx">
                                    <table class="table2" id="itemTable">
                                      <thead>
                                        <tr>
                                          <th contenteditable="true">Oral Medicine</th>
                                          <th>Quantity</th>
                                          <!-- <th contenteditable="true">Injunction</th> -->
                                        </tr>
                                      </thead>
                                      <tbody id="itemBody">
                                      </tbody>
                                    </table>
                                    <div class="form-check-label text-right">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="form-group mt-1 mb-3 text-right">
                            <!-- <div class="radio my-4"><label class="form-check-label pt-1"><input class="form-check-input mt-1" type="checkbox">Freeze Package</label></div> -->
                            <button id="addItemButton" data-bs-toggle="modal" data-bs-target="#myModal4" type="button"
                              class="btn-secondary btn-style btn mt-3 mr-2"><strong><i class="fa-solid fa-plus"></i>
                                Add Items</strong></button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                  <!--Div pharmacy ends-->

                  <!--Div Services starts-->
                  <div class="tab-pane fade show active" id="nav-appointment" role="tabpanel"
                    aria-labelledby="nav-appointment-tab">
                    <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                      <div class="card card_border">
                        <div class="mb-3">
                          <div class="form-group">
                            <div class="col-xl-12 p-heading">

                              <!-- Nav Tabs are here once have a look--->
                              <h6 class="p-text">SERVICES</h6>
                            </div>
                          </div>
                        </div>


                        <div class="card-body pt-0 pb-2">
                          <h6 class="primary">LIST OF SERVICES</h6>
                        </div>

                        <div class="card-body pt-1 pb-3">
                          <form id="serviceDataList">
                            <div class="col-12 mb-0">
                              <div class="">
                                <div class="col col-12 pr-xl-0 pl-xl-0">
                                  <div class="slidx">
                                    <table class="table2" id="serviceTable">
                                      <thead>
                                        <tr>
                                          <th>S.No</th>
                                          <th>Description</th>
                                          <th>Quantity</th>
                                          <th>Rate</th>
                                          <th>Amount</th>
                                          <th>Discount &nbsp;&nbsp;<span><input type="checkbox" id="percentageDiscount">%</span></th>
                                          <th>Net Amount</th>
                                        </tr>
                                      </thead>
                                      <tbody id="serviceBody">
                                        <!-- <tr>
                                          <td contenteditable="true">Misc. Charges (P)</td>
                                          <td contenteditable="true"
                                            class="o text-primary bg-light border-0 hover-bg-blue hover-underline"
                                            data-bs-toggle="modal" data-bs-target="#myModalDefineRule">Define
                                            Rule</td>
                                          <td contenteditable="true">Rate - Adjustable Head (P)</td>
                                          <td contenteditable="true">Quantity - 1</td>
                                          <td contenteditable="true">Gender - Both</td>
                                          <td contenteditable="true"> Discount - 0%</td>
                                          <td contenteditable="true"><i class="fa-solid fa-trash-can"
                                              style="color: red;"></i></td>
                                        </tr>

                                        <tr>

                                          <td contenteditable="true" colspan="7" class="text-left px-3 py-2">
                                            Procedure : OTHERS
                                          </td>

                                        </tr>

                                        <tr>
                                          <td contenteditable="true">Schedule -</td>
                                          <td contenteditable="true"><input class="form-check-input mt-1 "
                                              type="checkbox" id="gridCheck1">1</td>
                                          <td contenteditable="true"><input class="form-check-input mt-1 "
                                              type="checkbox" id="gridCheck1">2</td>
                                          <td contenteditable="true"><input class="form-check-input mt-1 "
                                              type="checkbox" id="gridCheck1">3</td>
                                          <td contenteditable="true"><input class="form-check-input mt-1 "
                                              type="checkbox" id="gridCheck1">4</td>
                                          <td contenteditable="true"><input class="form-check-input mt-1 "
                                              type="checkbox" id="gridCheck1">5</td>
                                          <td contenteditable="true"></td>

                                        </tr> -->
                                      </tbody>
                                      <tfoot id="MyTableFoot" style="display: none;">
                                        <tr>
                                          <td></td>
                                          <td>Miscellenious</td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td id="miscelleniousid">Null</td>
                                        </tr>
                                        <tr>
                                          <td></td>
                                          <td>Total Discount</td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td id="totalDiscountid">Null</td>
                                        </tr>
                                        <tr>
                                          <td></td>
                                          <td>Total Amount</td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td></td>
                                          <td id="totalAmountid">Null</td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>

                        </div>
                        <!-- <div style="display: flex;padding: 24px;justify-content: space-between;">
                          <div>
                            <p style="font-size: medium;">Miscellenious: <span id="miscelleniousid">Null</span></p>
                            <p style="font-size: medium;">Total Discount: <span id="totalDiscountid">Null</span></p>
                          </div>
                          <div>
                            <p style="font-size: medium;">Total Amount: <span id="totalAmountid">Null</span></p>
                          </div>
                        </div> -->
                      </div>
                    </div>
                    <div class="form-group mt-1 mb-3 text-right">
                      <button data-bs-toggle="modal" data-bs-target="#myModal5" type="button"
                        class="btn-secondary btn-style btn mt-3"><strong><i class="fa-solid fa-plus"></i> Add
                          Services / Groups</strong></button>
                      <button class="btn-primary btn-style btn mt-3" id="savePackagebutton"><strong><i class="far fa-save"></i> Save
                          Items</strong></button>
                    </div>
                    </form>
                    <!-- Pop Up for Define Rule -->
                    <div class="modal" id="myModalDefineRule" style="background:#66666694">
                      <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                          <!-- Modal Header -->
                          <div class="modal-header">
                            <a href="#" class="btn-close" data-bs-dismiss="modal"><i
                                class="fa-solid fa-circle-xmark"></i></a>
                          </div>
                          <!-- Modal Body -->
                          <div class="modal-body">
                            <div class="chart">
                              <form id="defienRuleId">
                                <div class="row">
                                  <!-- <div class="col-lg-12 pl-lg-0 mt-2 ml-2">
                                                            <h4 class="primary">Company</h4>
                                                        </div> -->
                                  <div class="col-lg-12 pl-lg-2 chart-grid">

                                    <div class="card card_border mt-3">
                                      <div>
                                        <!--Past your code here starts-->


                                        <div class="card">
                                          <div class="col-xl-12 p-heading">
                                            <h6 class="p-text">Misc. Charges (P)</h6>
                                          </div>

                                          <div class="col-lg-12 col-md-12 col-sm-12">
                                            <div class="form-check-label">
                                              <!-- <label class="form-check-label pr-4 pt-1 ml-2">
                                                <input id="adjustable-head-checkbox" class="form-check-input mt-1"
                                                  type="checkbox">
                                                Adjustable Head
                                              </label> -->
                                              <!-- <div id="adjustable-head-options" class="radio mt-2"
                                                style="display: none;">
                                                <label class="form-check-label pr-4 pt-1">
                                                  <input class="form-check-input mt-1" type="radio" name="head-type"
                                                    value="clinical"> Clinical
                                                </label>
                                                <label class="form-check-label pl-4 pr-4 pt-1">
                                                  <input class="form-check-input mt-1" type="radio" name="head-type"
                                                    value="pharmacy"> Pharmacy
                                                </label>
                                              </div> -->
                                            </div>
                                          </div>
                                          <div class="form-row card-body pb-2 pt-2">
                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group"><label
                                                  class="input__label">Procedure</label><select id="procedure-field"
                                                  name="procedure" class="form-control input-style">
                                                  <option value="days">Days</option>
                                                  <option>Select</option>
                                                </select>
                                              </div>
                                            </div>
                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group"><label class="input__label">Gender</label><select
                                                  name="gender" class="form-control input-style">
                                                  <option>Select</option>
                                                  <option value="male">Male</option>
                                                  <option value="female">female</option>
                                                </select>
                                              </div>
                                            </div>
                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group"><label class="input__label">Applicable
                                                  Relations</label><select name="applicable_relations"
                                                  class="form-control input-style">
                                                  <option value="days">Days</option>
                                                  <option>Select</option>
                                                </select>
                                              </div>
                                            </div>

                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group">
                                                <label class="input__label">Age Limit</label>
                                                <input name="age_limit" type="text" class="form-control input-style"
                                                  placeholder="0">
                                              </div>
                                            </div>

                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group">
                                                <label class="input__label">Discount (%)</label>
                                                <input name="discount" type="text" class="form-control input-style"
                                                  placeholder="00">
                                              </div>
                                            </div>

                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group">
                                                <label class="input__label">Quantity</label>
                                                <input type="number" class="form-control" id="quantity" placeholder="0"
                                                  name="quantity">
                                              </div>
                                            </div>

                                            <div class="col-lg-3 col-md-6 col-sm-12">
                                              <div class="form-group">
                                                <div class='d-flex'>
                                                  <label class="form-check-label pl-4 pr-4 pt-1">
                                                    <input class="form-check-input mt-1" type="radio" name="rate_type"
                                                      value="fixed"> Fixed
                                                  </label>
                                                  <label class="form-check-label pl-4 pr-4 pt-1">
                                                    <input class="form-check-input mt-1" type="radio" name="rate_type"
                                                      value="percentage"> Percentage
                                                  </label>
                                                  <label class="form-check-label pl-4 pr-4 pt-1">
                                                    <input class="form-check-input mt-1" type="radio" name="rate_type"
                                                      value="same-as-doctor-share"> Same As
                                                    Doctor Share
                                                  </label>
                                                </div>
                                                <label class="input__label">Rate / Limit</label>
                                                <input id="rate-limit" name="rate_limit" type="number"
                                                  class="form-control input-style" placeholder="00">
                                              </div>
                                            </div>
                                          </div>

                                          <div class="col-lg-12 col-md-12 col-sm-12">
                                            <div class="form-check-label">
                                              <div class="radio mt-2 mb-3">
                                                <label class="form-check-label pl-4 pr-4 pt-1"><input
                                                    id="is_consumables_field" class="form-check-input mt-1"
                                                    name="is_consumables" type="checkbox">
                                                  Is Consumables</label>

                                                <label class="form-check-label pl-4 pr-4 pt-1"><input
                                                    class="form-check-input mt-1" type="checkbox"
                                                    name="discount_on_quantity" id="discount_on_quantity">
                                                  Discount On Quantity</label>

                                                <label class="form-check-label pl-4 pr-4 pt-1"><input
                                                    class="form-check-input mt-1" type="checkbox"
                                                    name="unlimited_quantity" id="unlimited_quantity">
                                                  Unlimited Quantity</label>

                                                <label class="form-check-label pl-4 pr-4 pt-1"><input
                                                    class="form-check-input mt-1" type="checkbox"
                                                    name="include_in_adjustable_head" id="include_in_adjustable_head">
                                                  Include In Adjustable Head</label>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                        <!--Past your code here ends-->
                                      </div>
                                    </div>

                                  </div>
                                  <!--section2-->
                                  <!-- <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                                  <div class="card card_border">
                                    <div class="mb-3">
                                      <div class="form-group">
                                        <div class="col-xl-12 p-heading">
                                          <h6 class="p-text">FOLLOWUP CALENDER</h6>
                                        </div>
                                      </div>
                                    </div>

                                    <div class="col-lg-12 col-md-12 col-sm-12">
                                      <div class="form-check-label">
                                        <div class="radio mb-2 mt-0">

                                          <label class="form-check-label pt-1"><input class="form-check-input mt-1"
                                              type="checkbox">Followup Not
                                            Required</label>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-row card-body pt-0 pb-3">
                                      <div class="col-12 mb-0">
                                        <div class="form-group">
                                          <div class="col col-12 pr-xl-0 pl-xl-0">
                                            <div class="table-container mt-3">
                                              <table class="table table-bordered table2">
                                                <thead>
                                                  <tr id="tableHeader" class="table-header">
                                                    <th contenteditable="true">01</th>
                                                  </tr>
                                                </thead>
                                                <tbody id="tableBody" class="table-body">
                                                  <tr id="defaultRow">
                                                    <td contenteditable="true"><input class="form-check-input mt-1"
                                                        type="checkbox"></td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div> -->
                                </div>
                                <div class="form-group mt-1 mb-3 text-right">

                                  <button type="button" class="btn-danger btn-style btn mt-3 mr-2"
                                    data-bs-dismiss="modal"><strong><i class="fas fa-times"></i>
                                      Cancel</strong></button>

                                  <button type="submit" class="btn-primary btn-style btn mt-3"><strong><i
                                        class="far fa-save"></i>
                                      Save</strong></button>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Div Services ends-->
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
    
    </div>

    <!-- Add Services/Groups -->
    <div class="modal" id="myModal5" style="background:#66666694">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <a href="#" class="btn-close" data-bs-dismiss="modal"><i class="fa-solid fa-circle-xmark"></i></a>
          </div>
          <!-- Modal Body -->
          <div class="modal-body">
            <div class="chart">

              <div class="row">
                <div class="col-lg-12 pl-lg-2 chart-grid">
                  <div class="card card_border mt-3">
                    <div>
                      <div class="card">
                        <div class="col-xl-12 p-heading">
                          <h6 class="p-text">SERVICE DETAILS</h6>
                        </div>
                        <div class="form-row card-body pb-3 pt-3">

                          <div class="col-lg-3 col-md-6 col-sm-12">
                            <div class="form-group">
                              <label class="input__label">Service Name</label>
                              <input type="hidden" class="form-control" id="service_id" name="service_id" />
                              <select name="service_name" id="service_name" class="form-control input-style">
                                <option value="">Select Service</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-lg-2 col-md-2 col-sm-12 text-left">
                            <div class="form-group">
                              <button type="button" class="btn btn-style mt-4 btn-primary btn-style btn-change">
                                <strong><i class="fas fa-search"></i> Search</strong>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--section2-->

                <div class="mt-1 col-lg-12 pl-lg-2 pr-lg-3">
                  <div class="card card_border">
                    <div class="mb-3">
                      <div class="form-group">
                        <div class="col-xl-12 p-heading">
                          <h6 class="p-text">LIST OF SERVICE</h6>
                        </div>
                      </div>
                    </div>
                    <form id="addServices">
                      <div class="form-row card-body pt-0 pb-3">

                        <div class="col-12 mb-0">
                          <div class="form-group">
                            <div class="col col-12 pr-xl-0 pl-xl-0">
                              <div class="slidx">
                                <table class="table2" id="serviceTable">
                                  <input type="hidden" name="PackageId" id="ServicePackageId">
                                  <thead>
                                    <tr>
                                      <th></th>
                                      <th>Service Name</th>
                                      <th>Rate</th>
                                    </tr>
                                  </thead>
                                  <tbody id="serviceList">
                                  </tbody>
                                </table>
                              </div>
                              <div id="paginationControls"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
              <div class="form-group mt-1 mb-3 text-right">
                <button id="packageAddButton" class="btn-secondary btn-style btn mt-3 mr-2" ><strong><i
                      class="fa-solid fa-plus"></i> Add</strong></button>
                <button type="button" class="btn-danger btn-style btn mt-3" data-bs-dismiss="modal"><strong><i
                      class="fas fa-times"></i>
                    Cancel</strong></button>
              </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Add Items Model -->
    <div class="modal " id="myModal4" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
      style="background:#66666694">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <a href="#" class="btn-close" data-bs-dismiss="modal"><i class="fa-solid fa-circle-xmark"></i></a>
          </div>
          <!-- Modal body -->
          <div class="container-fluid">
            <form id="addItem">
              <div class="chart">
                <div class="row">
                  <div class="col-lg-12 pl-lg-2 chart-grid">
                    <div class=" mt-3">
                      <div class="slidx">
                        <table class="table2" id="medicineListTable">
                          <input type="hidden" name="PackageId" id="medicineListPackageId">
                          <thead>
                            <tr>
                              <th></th>
                              <th>Oral Medicine</th>
                              <th>Injunction</th>
                            </tr>
                          </thead>
                          <tbody id="medicineList">
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group mt-1 mb-3 text-right">
                  <button type="button" class="btn-danger btn-style btn mt-3 mr-2" data-bs-dismiss="modal"><strong><i
                        class="fas fa-times"></i>
                      Cancel</strong></button>

                  <button type="submit" id="addMedicineButton" class="btn-primary btn-style btn mt-3 btn-close"
                    data-bs-dismiss="modal"><strong><i class="fas fa-check"></i>
                      OK</strong></button>
                </div>

              </div>
            </form>
          </div>
        </div>
      </div>
      <!--footer section start-->
      <%- include('../footer'); -%>
    

 <script>
  let totalRate = 0;
  let packageData = [];
  function fetchData() {
    axios.get('/package/getNewPackage')
        .then(response => {
            let data = response.data;
            packageData = data;
            let tableRows = '';

            data.forEach((item) => {
                tableRows += `
                <tr data-id="${item.id}" onclick="HandleSelectedRow(this)">
                   <td>${item.packageCode}</td>
                   <td>${item.packageName}</td>
                   <td>${item.shortDescription}</td>
                   <td>${item.longDescription}</td>
                   <td>${item.specialization}</td>
                   <td>${item.subSpecialization}</td>
                   <td>${item.packageRate}</td>
                   <td><input class="form-check-input mt-0 status-checkbox" type="checkbox" ${item.status ? 'checked' : ''}></td>
                   <td><input class="form-check-input mt-0 status-checkbox" type="checkbox" ${item.packageFreezed ? 'checked' : ''}></td>
                   <td><input class="form-check-input mt-0 status-checkbox" type="checkbox" ${item.packageApproved ? 'checked' : ''}></td>
                </tr>
                `;
            });

            $('#categtable').html(tableRows);
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
}
 fetchData()

setPackageId = "";
function HandleSelectedRow(selectedRow) {
  // console.log();
  setPackageId = selectedRow.getAttribute("data-id");
  
    $('tr').removeClass('locked');
    $(selectedRow).addClass('locked');
    $('#myButton1').removeAttr('disabled');
    $('#myButton2').removeAttr('disabled');
    $('#myButton3').removeAttr('disabled');
    $('#errordiv1').text('');
    


    const code = $(selectedRow).find('td').eq(0).text();
    const name = $(selectedRow).find('td').eq(1).text();
    const rate = $(selectedRow).find('td').eq(6).text();
    $('#package_code').val(code);
    $('#packageName').val(name);
    $('#packageAmount').val(rate);
    console.log(rate);
    
    totalRate = rate;
    fetchConcent(code);
}

function fetchConcent(packageCode) {
    axios.get(`/package/getConcents/${packageCode}`)
        .then(function (response) {
            const allConcents = response.data.allConcents;
            const selectedConcentCodes = new Set(response.data.packageConsents.map(pc => pc.concents).flat());

            let tableRows = '';
            allConcents.forEach(function(item) {
                const isChecked = selectedConcentCodes.has(item.concent_desc) ? 'checked' : '';
                tableRows += `
                    <tr concent-id="${item.concent_code}">
                        <td><input class="form-check-input mt-0 consent-checkbox" type="checkbox" ${isChecked}></td>
                        <td>${item.concent_desc}</td>
                    </tr>
                `;
            });

            $('#concentBody').html(tableRows);
        })
        .catch(function (error) {
            console.error('Error fetching consent details:', error);
        });
}

$('#concent_form').submit(function(event) {
    event.preventDefault();
    var packageCode = $('#package_code').val();
    var selectedData = $('#concentBody tr').toArray().filter(row => $(row).find('input[type="checkbox"]').is(':checked')).map(row => $(row).find('td').eq(1).text());

    if (selectedData.length > 0) {
        axios.post('/package/saveConcent', {
            package_code: packageCode,
            concents: selectedData
        })
        .then(function(response) {
            console.log('Save successful:', response);
            $('#errordiv1').removeClass('alert-danger').addClass('alert-success').text(response.data.message).show();
        })
        .catch(function(error) {
            console.error('Error saving data:', error);
            $('#errordiv1').removeClass('alert-success').addClass('alert-danger').text(error.response.data.message).show();
        });
    } else {
        console.log('No rows selected.');
        $('#errordiv1').removeClass('alert-success').addClass('alert-danger').text('No rows selected').show();
    }
});

// Toggle 'selected' class on table rows when clicked
$('#concentBody').on('click', 'tr', function(event) {
    // Prevent row from being selected when clicking on the checkbox directly
    if (!$(event.target).is('input[type="checkbox"]')) {
        $(this).find('input[type="checkbox"]').trigger('click');
    }
    $(this).toggleClass('selected');
});
let data = null

async function fetchServicesData() {

    axios.get('/billing/get-service')
        .then(response => {
          console.log(response);
            data = response.data;
            let tableRows = '';

            data.forEach((item,i) => {
              console.log(i);
              
                tableRows += `
                <tr>
                  <td><input id="${i}" type="checkbox"></td>
                  <td>${item.serviceName}</td>
                  <td>${item.baseServiceRate}</td>
                  <td style="display:none">${item.serviceCode}</td>
                </tr>
                `;
            });

            $('#serviceList').html(tableRows);
            
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
        await fetchCityData();
}

// Package array to store new rows
let packageArray = [];
let quantityArray = [];
let inputArray = [];
let serviceIdsArray = [];
// let totalServices = 0;
let totalDiscount = 0;
let totalAmount = 0;
let service_amount = 0;
let package_amount = 0;

document.addEventListener('click', function(e) {
    if (e.target.matches('#serviceList input[type="checkbox"]')) {
        console.log("Checkbox clicked");

        const checkbox = e.target;
        const selectedBatchRow = checkbox.closest('tr');
        
        // Use setTimeout to delay our logic until after the browser updates the checkbox state
        setTimeout(() => {
          if (checkbox.checked) {
                const id = parseInt(checkbox.getAttribute('id'));
                console.log("Service ID:", id);
                
                const newRow = `
                    <tr name="services" id="row-${id}">
                        <td>${id+1}</td>
                        <td name="serviceName">${data[id].serviceName}</td>
                        <td name="quantity"><input type="number" id="quantity-${data[id].id}" value="1" data-rate="${data[id].baseServiceRate}" data-id="${data[id].id}" /></td>
                        <td name="baseServiceRate">${data[id].baseServiceRate}</td>
                        <td id="total-${data[id].id}">${data[id].baseServiceRate}</td>
                        <td name="netServiceDiscount"><input type="number" id="discount-${data[id].id}" data-rate="${0}" data-id="${data[id].id}" /></td>
                        <td name="netServiceAmount" id="net_amount-${data[id].id}">${data[id].baseServiceRate}</td>
                        <td style="display:none" name="serviceCode" id="serviceCode-${data[id].id}">${data[id].serviceCode}</td>
                    </tr>
                `;
                totalAmount += parseFloat(data[id].baseServiceRate)
                serviceIdsArray.push(id);
                // document.getElementById('totalAmountid').innerText = totalAmount;
                
                // Add to packageArray
                packageArray.push(newRow);
                const quantityId = `quantity-${data[id].id}`;
                const discountId = `discount-${data[id].id}`;
                quantityArray.push(quantityId);
                inputArray.push({
                  quantityId: quantityId,
                  dicountId: discountId
                })
                
            } else {
              const id = parseInt(checkbox.getAttribute('id'));
              serviceIdsArray = serviceIdsArray.filter(sid => sid!== id);
              totalAmount -= parseFloat(data[id].baseServiceRate);
              totalServices--;

              
                // If the checkbox is unchecked, remove the corresponding row from serviceBody
              const serviceId = checkbox.getAttribute('id');
              document.getElementById(`row-${serviceId}`).remove();
            }
        }, 0);
    }
});

// Function to handle input and calculate the total
function handleQuantityInput(e) {
    const quantity = parseFloat(e.target.value) || 0; // Get the input value or default to 0
    const rate = parseFloat(e.target.getAttribute('data-rate')); // Get the rate from the data attribute
    const id = e.target.getAttribute('data-id'); // Get the id to update the correct total

    // Calculate the total
    const total = quantity * rate;
    const previousTotal = document.getElementById(`total-${id}`).textContent;
    if(previousTotal) totalAmount -= parseFloat(previousTotal);
    if(totalAmount < 0) totalAmount = 0;
    totalAmount += total;
    document.getElementById(`total-${id}`).textContent = total;
    adjustPrice();

    // document.getElementById('totalAmountid').innerText = totalAmount;
    // // Update the total in the table
    // document.getElementById(`total-${id}`).textContent = total;
    // document.getElementById(`net_amount-${id}`).textContent = total;
    return total;
}

const handleDiscount = (e,rate)=>{ 
  let discount = parseFloat(e.target.value) || 0;
  const id = e.target.getAttribute('data-id');
  let netTotal = parseInt(document.getElementById(`total-${id}`).textContent);
  const val = document.getElementById("percentageDiscount");
  if(val.checked){
    discount = (discount * netTotal)/100;
  }
  let givenDiscount = totalDiscount - discount;
  
  // console.log(id);
  
  let mtotal = netTotal;
  console.log(netTotal);
  netTotal -= discount;
  console.log(netTotal);
  if(netTotal<0) netTotal = 0;

  document.getElementById(`net_amount-${id}`).textContent = netTotal;
  if(givenDiscount>0){
    for(let i=0;i<serviceIdsArray.length;i++){
      if(data[serviceIdsArray[i]].id == id)continue;
      let baseprice = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
      let discount = (baseprice/(totalAmount-mtotal)) * givenDiscount;
      const val = document.getElementById(`discount-${data[serviceIdsArray[i]].id}`);
      val.value = discount.toFixed(2);
      const total = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
      document.getElementById(`net_amount-${data[serviceIdsArray[i]].id}`).textContent = total - discount.toFixed(2);
      netTotal += total - discount.toFixed(2);
      console.log(val.value);    
    }      
  }
  
  if(val.checked){
    for(let i=0;i<serviceIdsArray.length;i++){
      if(data[serviceIdsArray[i]].id == id)continue;
      const netval = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
      const discountVal = parseFloat(document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value);
      let newPercentageVal = (discountVal/netval)*100;
      document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value = newPercentageVal.toFixed(2);
  }
    // console.log("checked");
  }

  document.getElementById('totalAmountid').innerText = netTotal;
}

let rightNowId = "fixed";

$(document).ready(function(){
    $('#packageAddButton').click((e) => {
      e.preventDefault();
        // Append all rows at once
        $('#serviceBody').append(packageArray.join(''));
        // document.getElementById('totalAmountid').innerText = totalAmount;
        adjustPrice();
        console.log(inputArray);
        $('#MyTableFoot').css("display","");
        
        // Add event listeners to all quantity inputs
        inputArray.forEach(input => {
            const quantityInput = document.getElementById(input.quantityId);
            const discountInput = document.getElementById(input.dicountId);
            let baseValue = 0;
            if (quantityInput) {
              quantityInput.addEventListener('input',handleQuantityInput);
            }
            if(discountInput) {
              discountInput.addEventListener('input', (e)=>handleDiscount(e, baseValue))
            }

        });
        
        // Clear the arrays after adding
        packageArray = [];
        inputArray = [];
    });
    $('#serviceComponent').change(()=>{
      service_amount = parseInt($('#serviceComponent').val());
      if(rightNowId == "percentage"){
        package_amount = 100 - service_amount;
        $('#pharmacyComponent').val(package_amount.toFixed(2));
        package_amount = (totalRate * package_amount)/100;
        service_amount = (totalRate * service_amount)/100;
        adjustPrice();
        return;
      }
      package_amount = totalRate - service_amount;
      $('#pharmacyComponent').val(package_amount);
      console.log(service_amount);
      adjustPrice();
    // fetchServicesData(componentId);
  })
  $('#pharmacyComponent').change(()=>{
    package_amount = parseInt($('#pharmacyComponent').val());
    if(rightNowId == "percentage"){
      service_amount = 100 - package_amount;
      $('#serviceComponent').val(service_amount.toFixed(2));
      service_amount = (totalRate * service_amount)/100;
      package_amount = (totalRate * package_amount)/100;
      adjustPrice();
      return;
    }
    service_amount = totalRate - package_amount
    $('#serviceComponent').val(service_amount);
    adjustPrice();
  });
  $('#my-radio-button input[type="radio"]').on('change', function(e) {
        const id = e.target.id;
        rightNowId = id;
        if(id == "percentage"){
          service_amount = (service_amount/totalRate)*100;
          package_amount = (package_amount/totalRate)*100;
          $('#serviceComponent').val(service_amount.toFixed(2));
          $('#pharmacyComponent').val(package_amount.toFixed(2));
        }else {
          service_amount = (totalRate * service_amount)/100;
          package_amount = (totalRate * package_amount)/100;
          $('#serviceComponent').val(service_amount.toFixed(2));
          $('#pharmacyComponent').val(package_amount.toFixed(2));
        }
        const selectedName = $(this).attr('name');
        console.log('Selected radio button name:', selectedName);
    });

});
let cityData = null;

function adjustPrice(){
  if(totalAmount > service_amount) {
          totalDiscount = totalAmount - service_amount;
          let netTotal = 0;
          for(let i=0;i<serviceIdsArray.length;i++){
              let baseprice = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
              let discount = (baseprice/totalAmount) * totalDiscount;
              const val = document.getElementById(`discount-${data[serviceIdsArray[i]].id}`);
              val.value = discount.toFixed(2);
              const total = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
              let nval = total - discount.toFixed(2);
              document.getElementById(`net_amount-${data[serviceIdsArray[i]].id}`).textContent = nval.toFixed(2);
              netTotal += total - discount.toFixed(2);
              // console.log(val.value);    
            }
          document.getElementById('totalAmountid').innerText = netTotal.toFixed(2);
          document.getElementById('totalDiscountid').innerText = totalDiscount.toFixed(2);
          document.getElementById('miscelleniousid').innerText = 0;    
  }else{
    document.getElementById('miscelleniousid').innerText = service_amount - totalAmount;
    document.getElementById('totalDiscountid').innerText = 0;
  }
}

function fixedToPercentage(){
  for(let i=0;i<serviceIdsArray.length;i++){
    const netval = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
    const discountVal = parseFloat(document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value);
    let newPercentageVal = (discountVal/netval)*100;
    document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value = newPercentageVal.toFixed(2);
  }
}

function percentageToFixed(){
  for(let i=0;i<serviceIdsArray.length;i++){
    const netval = parseInt(document.getElementById(`total-${data[serviceIdsArray[i]].id}`).textContent);
    const discountVal = parseFloat(document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value);
    let newFixedVal = (netval * discountVal)/100;
    document.getElementById(`discount-${data[serviceIdsArray[i]].id}`).value = newFixedVal.toFixed(2);
  }
}

document.getElementById("percentageDiscount").addEventListener("change",()=>{
  // console.log("hello");
  const val = document.getElementById("percentageDiscount");
  if(val.checked){
    console.log("checked");
    fixedToPercentage();
  }else{
    percentageToFixed();
  }
})

function fetchCityData() {
  axios.get('/package/drugs').then(response => {
    cityData = response.data;
    console.log(cityData);
    console.log(packageData);
    
    let tableRows = '';

    cityData.forEach((item,i) => {
    console.log(i);
              
    tableRows +=`
                <tr>
                  <td><input id="${i}" type="checkbox"></td>
                  <td>${item.item_name}</td>
                  <td>${item.availableStock}</td>
                </tr>
                `;
            });

    $('#medicineList').html(tableRows);
    
    // Bind the event handlers to the newly added row
    // bindSearchEvents(rowCount, cityData);
    })
    .catch(error => {
      console.error('Error loading city data:', error);
    });
    // fetchCityData();
}

medicinePackageArray = [];

document.addEventListener('click', function(e) {
    if (e.target.matches('#medicineList input[type="checkbox"]')) {
        console.log("Checkbox clicked");

        const checkbox = e.target;
        const selectedBatchRow = checkbox.closest('tr');
        
        // Use setTimeout to delay our logic until after the browser updates the checkbox state
        setTimeout(() => {
          if (checkbox.checked) {
                const id = parseInt(checkbox.getAttribute('id'));
                console.log("Service ID:", id);
                
                const newRow = `
                    <tr name="myMedicines" id="medrow-${id}">
                        <td>${cityData[id].item_name}</td>
                        <td><input type="number" id="quantity-${cityData[id].id}"/></td>
                    </tr>
                `;
                // totalAmount += parseFloat(data[id].baseServiceRate)

                // document.getElementById('totalAmountid').innerText = totalAmount;
                
                // Add to packageArray
                medicinePackageArray.push(newRow);
                
                
            } else {
                // If the checkbox is unchecked, remove the corresponding row from serviceBody
              const serviceId = checkbox.getAttribute('id');
              document.getElementById(`medrow-${serviceId}`).remove();
            }
        }, 0);
    }
});

$(document).ready(()=>{
  $('#addMedicineButton').click(()=>{
    $('#itemBody').append(medicinePackageArray.join(''));
    medicinePackageArray = [];
  })
})


const savebutton = document.getElementById('savePackagebutton');
  savebutton.addEventListener('click',(e)=>{
    e.preventDefault();
    const services = document.getElementsByName("services");
    const medicines = document.getElementsByName("myMedicines");
    console.log(services);
    const serviceComponent = document.getElementById("serviceComponent").value;
    const pharmacyComponent = document.getElementById("pharmacyComponent").value;
    const serviceArray = [];
    const medicineArray = [];
    
    for(let i=0;i<services.length;i++){
      // console.log(services[i].id);
      const service = services[i].id;
      const id = parseInt(service.split("-")[1]);
      const serviceId = data[id].id;
      const serviceName = data[id].serviceName;
      const quantity = document.getElementById(`quantity-${data[id].id}`).value;
      const discount = document.getElementById(`discount-${data[id].id}`).value;
      const netAmount = document.getElementById(`net_amount-${data[id].id}`).innerText;
      const serviceCode = document.getElementById(`serviceCode-${data[id].id}`).innerText;
      serviceArray.push({serviceId,serviceName, quantity, discount, netAmount,serviceCode});
    }

    for(let i=0;i<medicines.length;i++){
      const medicine = medicines[i].id;
      const id = parseInt(medicine.split("-")[1]);
      const medicineId = cityData[id].id;
      const medicineName = cityData[id].item_name;
      const quantity = document.getElementById(`quantity-${cityData[id].id}`).value || 0;
      medicineArray.push({medicineId, medicineName, quantity});
    }
    // console.log();
    
    // const selecetedPackege = packageArray.filter((pack)=> pack.id.toString() == setPackageId);
    // console.log(selecetedPackege);
    
    // const {packageCode,packageName} = selecetedPackege[0];

    const mydata = {
      packageId:setPackageId,
      serviceComponent,
      pharmacyComponent,
      serviceArray,
      medicineArray,
      totalAmount,
      totalDiscount,
      totalRate,
      // packageCode,
      // packageName,
    }
    console.log(mydata)
    const fetchData = () => {
  axios.post("/package/addpackageitems", mydata)
    .then(response => {
      console.log(response);
      alert('Saved Succesfully')
      // You can save or process the response here as needed
    })
    .catch(error => {
      console.error("Error fetching data:", error);
    });
};

    fetchData();

    console.log(serviceArray);
    
    
    console.log("hello");
    
  })

</script>



